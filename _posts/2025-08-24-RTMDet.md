---
layout: post
title: "🧩 RTMDet, SOTA of Real-Time, One-Stage Object Detectors: 실시간, One-Stage Object Detector의 정수"
author: [DrFirst]
date: 2025-08-24 10:00:00 +0900
categories: [AI, Research]
tags: [RTMDet,One-stage, Object Detector]
sitemap:
  changefreq: monthly
  priority: 0.8
---

---

### 🧩 (한국어) RTMDet : YOLO Family의 새로운 강자!   

* **제목**: [TMDet: An Empirical Study of Designing Real-Time Object Detectors ](https://arxiv.org/pdf/2212.07784)  
* **프로젝트/데모**: [Github](https://github.com/open-mmlab/mmyolo/tree/main/configs/rtmdet)  
* **핵심 키워드**: `Real-Time Detection`, `One-Stage`, `Large-Kernel DWConv`, `Dynamic Label Assignment`, `Deployment`  
* **요약**: RTMDet는 **실시간(Real-Time)** 성능을 목표로, **백본–넥 용량 균형**, **대형 커널 Depthwise Conv** 블록, **동적 라벨 할당+소프트 라벨** 등 **설계 선택지들의 실증 비교**를 통해 **속도–정확도–배포 용이성**을 동시에 달성한 1-Stage Object Detector  

---


### 🚀 RTMDet 핵심 요약

> 한 줄 요약: **RTMDet = 전역 컨텍스트를 잘 보고, 학습은 똑똑하게, 확장은 쉽게, 성능은 빠르고 정확하게!**  

1) **효율적인 모델 구조 🧠**  
- **넓은 시야**: 큰 커널(대형 필터)로 한 번에 **전역 문맥**을 포착.  
- **스마트한 설계**: **깊이↓·폭↑**로 연산 낭비 없이 속도·정확도 균형 확보(재파라미터화 불필요).  

2) **더 똑똑해진 학습법 🎯**  
- **유연한 정답지(Soft Label)**: “100% 고양이” 대신 **확률적 타깃**으로 매칭 → 라벨 노이즈↓, 정확도↑.  
- **최적 레시피**: 증강·최적화·스케줄 조합을 다듬어 **수렴 안정성**과 **성능** 동시 향상.  

3) **뛰어난 확장성 🛠️**  
- **인스턴스 분할**: 커널+마스크 헤드만 추가해 **정밀한 물체 윤곽**까지 예측(**Segmentation**).  
- **회전 검출**: 박스 회귀 차원 확장(4→5)과 회전 디코더로 **기울어진 물체**도 정확히 탐지.  

4) **압도적 ‘가성비’ 성능 ⚡**  
- **다양한 사이즈**: Tiny~XL까지 **요구 성능·리소스**에 맞게 선택.  
- **실시간 처리**: 소형 모델은 **초당 1000장+** 처리도 가능, **적은 파라미터로 높은 AP** 달성.  

---

### 🔍 기존 연구들!!

- **효율적 객체 탐지 아키텍처**
  - 실시간 응용에서는 **앵커 기반**·**앵커 프리**의 **1-stage**가 주류(대표적으로 YOLO), **2-stage**는 속도땜시 상대적으로 비선호.
  - 더 빠른 감지를 위한 테크닉들이 등장!!: efficient backbone & model scaling strategies / multi-scale feature / NAS ／**re-parameterization**    
    - **efficient backbone & model scaling strategies**  
      - 경량 백본(예: MobileNet, ShuffleNet)과 **스케일링**(깊이/폭/입력해상도 조절; 예: EfficientNet의 compound scaling)로 **연산량을 예산에 맞춰** 튜닝해 **속도–정확도 균형**을 맞춥니다.
    - **multi-scale feature**  
      - **FPN/PAN** 등 피처 피라미드로 **작은/큰 물체**를 모두 잘 보도록 여러 해상도의 특징을 **융합**합니다(위–아래 전파 + 측면 연결).
    - **NAS (Neural Architecture Search)**  
      - 하드웨어/지연시간 제약을 넣고 **자동으로 아키텍처를 탐색**(진화/경사 기반)해, **특정 기기에서 최적의 구조**(속도–정확도)를 찾아냅니다.
    - **re-parameterization(배포 후 구조 단순화)**  
      - 학습 시 **다중 분기(Conv/Skip/BN)**로 표현력을 높이고, 배포 전 **단일 Conv로 합치기(BN folding 포함)** 해 **추론을 빠르게** 합니다(예: RepVGG/ACNet 스타일).
  - 본 논문 관점: **backbone&neck 용량을 호환**되게 설계하고, **대형 커널 DWConv**(large-kernel depth-wise convolutions)를 기본 블록에 도입한 **전체 아키텍처** 제안.  

- **라벨 할당(학습 손실 포함)**
  - 초기: **IoU 매칭**으로 “이 예측을 정답으로 볼지” 결정, 다만 **작은 물체/겹침/가장자리**에서 매칭 이슈 발생    
  - 이후: **좋은 후보를 똑똑하게 골라** 학습하고, **초반 불안정**을 줄여 **빨리·높이** 성능을 올리는 방식 연구  
    - **중심 기반 매칭(center-based)**  
      - 아이디어: **정답 박스의 한가운데에 가까운 예측**일수록 진짜일 가능성이 높다!  
      - 그래서 GT 박스 **중앙 근처(작은 사각형/원 영역)**에 있는 예측만 **후보**로 뽑고,  
        그중에서 **IoU·분류 점수**가 높은 것들을 **양성(positive)**으로 지정해 학습시켜요.  
      - 효과: **가장자리나 겹친 물체** 때문에 생기는 혼란을 줄여 **안정적으로 수렴**합니다.  
    - **적응형/동적 기준(ATSS·SimOTA 등)**  
      - 한 번에 정한 고정 임계값 대신, **이미지·객체마다** 상황을 보며  
        **Top-k 후보**(가까움·IoU·점수 기준)를 고르고 그 안에서 **양성**을 정합니다.  
      - 효과: 데이터마다 다른 **난이도/크기/밀집도**에 **유연하게** 대응 → **정확도↑ 수렴속도↑**.  
    - **보조 헤드(auxiliary head)로 ‘학습 안정화’**  
      - 학습할 때만 쓰는 **추가 예측 가지**(보조 헤드)를 달아 **신호를 더 세게·안정적으로** 줌    
      - 초반에 메인 헤드가 흔들릴 때 **보조 헤드가 길잡이** 역할을 함    
      - **추론(배포) 단계에서는 제거**하므로 **속도 손해 없음**  
  - 최근에는 **동적 라벨 할당(DLA)**로, 매 배치 상황에 맞춰 **유연하게 양성/음성**을 정해 **수렴과 정확도** 향상  
  - 이 논문의 포인트: **매칭 비용**을 계산할 때 **하드 라벨（T/F) 대신 소프트 라벨(가능성)**을 써서  
    → **좋은/나쁜 매칭 구분이 더 뚜렷**, **학습 더 안정**, **수렴 더 빠름**.

- **인스턴스 분할** like SAM  
  - 패러다임: **마스크 분류**, **Top-Down**, **Bottom-Up**.
  - 최근: **원스테이지**로 박스 **있음/없음** 모두 시도.
  - 핵심 흐름: **다이내믹 커널**로 커널을 생성해 마스크 특징에 합성.
  - 본 논문 확장: RTMDet에 **커널 예측 헤드 + 마스크 특징 헤드**를 추가해 인스턴스 분할 지원.

- **회전 객체 검출**
  - 위치·범주에 **방향(각도)**까지 예측.
  - 기존: 회전으로 생기는 **특징 미스얼라인먼트** 완화를 위한 특징추출 네트워크, **가우시안/볼록집합** 등 다양한 박스 표현 연구.
  - 본 논문 접근: **최소 수정**(각도 브랜치 추가, **GIoU→Rotated IoU Loss** 교체)으로 일반 검출기를 확장.
  - 결론: **고정밀 일반 검출기**의 아키텍처/지식이 **고정밀 회전 검출**로 이어짐을 보임.

---
> 구조부터는 어려워서,, 그냥 GPT가 써준내용임! 나중에 여유될떄 깊게 알압보자~  
## 🧱 RTMDet- Real-Time Models for object Detection 구조(Architecture)
- **Backbone**:  
  - **대형 커널 기반 Depthwise Conv** 블록을 채택해 **표현력↑ / 연산↓**를 양립.  
  - 단계별 채널·해상도 스케줄을 실시간 제약에 맞게 정렬.
- **Neck(FPN/PAN 계열)**:  
  - **백본–넥 용량 균형(compatible capacities)**을 중시해 **정보 병목** 최소화.  
  - 멀티스케일 특징 융합을 단순·일관되게 유지.  
- **Head(Anchor-free 계열)**:  
  - 분류·회귀 분지에 **동적 라벨 할당**을 적용, 학습 난이도에 따라 **유연한 매칭**을 수행.  
  - 경량 설계로 **고FPS** 유지, 다양한 크기 라인업(Tiny~XL) 제공.  

---

## 🔧 학습법(Training Recipe)
- **동적 라벨 할당 + 소프트 타깃**:  
  - 매칭 코스트에 기반한 동적 포지티브 선정, **소프트 라벨**로 경계 샘플의 학습 안정화.
- **증강·최적화 레시피 정제**:  
  - Mosaic/RandomAffine/MixUp 등 증강 강도를 **실시간 시나리오에 맞게 조절**.  
  - 학습 스케줄, EMA, 정규화·활성 함수 선택을 **실험적으로 튜닝**.
- **배포 친화**:  
  - ONNX/TensorRT, FP16/INT8 경로를 고려한 **연산 그래프 단순화**와 **NMS 설정** 일관화.

---

## 🧪 Ablation Study  
1) **대형 커널 DWConv의 효과**  
   - 대형 수용영역으로 **표현력** 확보, DWConv로 **연산량** 억제 → 실시간 영역에서 **정확도 상한선** 상승.
2) **백본–넥 용량 균형**  
   - 불균형 시 특정 해상도/채널 구간에서 **병목** 발생 → 균형 최적화가 **AP·안정성**에 직결.
3) **동적 라벨 + 소프트 라벨**  
   - 고난도·소물체 케이스에서 **수렴 안정성**과 **정밀도** 향상, 학습 초반 진동 감소.
4) **훈련 레시피 영향**  
   - 과도한 증강은 실시간 헤드의 **수렴 저해** 가능 → 적정 강도에서 **속도–정확도 트레이드오프** 최적화.
5) **라인업 확장성**  
   - Tiny~XL 규모 전반에서 일관된 이득 → **엣지~서버** 전 범위 적용성 확인.

---

## ✅ 결론
- **RTMDet**는 실시간 검출을 위한 **구조·라벨링·레시피**를 **실증적으로 정리**해,  
  **대형 커널 DWConv + 용량 균형 + 안정적 학습법**으로 **속도–정확도–배포성**의 균형을 끌어올림.
- **MMDetection/MMYOLO** 생태계와의 높은 호환성으로 **실무·연구 모두에 즉시 적용**하기 용이하며,  
  다양한 모델 크기·태스크(인스턴스 분할/회전 검출)로 **확장성** 또한 우수함.

---
